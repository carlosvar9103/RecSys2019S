{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# TRIVAGO RECSYS CHALLENGE"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import csv\n",
    "import random"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 1) Import data and random sample (session-based) from training: "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "input_path = \"data_raw/\"\n",
    "target_path = \"data_exports/\"\n",
    "\n",
    "def get_data_pure(name, input_path=input_path):\n",
    "    df = pd.read_csv(input_path+name,dtype=\"str\", sep=\",\", encoding=\"utf-8\", skipinitialspace=True)\n",
    "    return df\n",
    "\n",
    "#needed later for importing exported data (for storage reasons):\n",
    "def get_data_exported(name,target_path= target_path):\n",
    "    df = pd.read_csv(target_path+name,dtype=\"str\", sep=\",\", encoding=\"utf-8\", skipinitialspace=True)\n",
    "    return df\n",
    "\n",
    "def truncate_df(input,cutoff=0.02): #use per default 2% of the data\n",
    "    random.seed(3333)\n",
    "    sessions=input['session_id'].unique().tolist()\n",
    "    np.random.seed(3333)\n",
    "    if cutoff==1: #use entire data and keep the order:\n",
    "        sess_rand = sessions\n",
    "    else: #cut the data and randomly order it\n",
    "        np.random.seed(3333)\n",
    "        sess_rand = np.random.choice(sessions, size=int(np.floor(cutoff*len(sessions))), replace=False) #random sample of sessions without replacement\n",
    "    output= input.loc[input['session_id'].isin(sess_rand)]\n",
    "    return output"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "reading train..\n",
      "\n",
      "In the process, the dataset got truncated to 32.88 % of the size. \n",
      "\n",
      "Overall there are 910683 unique sessions, that's mean an average length of 17.49565106628761 per session. \n",
      "\n",
      "         user_id     session_id   timestamp step             action_type  \\\n",
      "81  02SRUT1NQYH1  3599a6f709eab  1541063730    1  interaction item image   \n",
      "82  02SRUT1NQYH1  3599a6f709eab  1541063730    2  interaction item image   \n",
      "\n",
      "   reference platform            city  device current_filters impressions  \\\n",
      "81   2795374       FI  Krakow, Poland  mobile             NaN         NaN   \n",
      "82   2795374       FI  Krakow, Poland  mobile             NaN         NaN   \n",
      "\n",
      "   prices  \n",
      "81    NaN  \n",
      "82    NaN   (5238803, 12)\n"
     ]
    }
   ],
   "source": [
    "np.random.seed(3333) #fix seed for random consistency\n",
    "\n",
    "print('reading train..\\n')\n",
    "train = get_data_pure('train.csv')\n",
    "\n",
    "#truncate the data to 33% of the size (for finaltraining run): \n",
    "train_sample = truncate_df(train,cutoff=0.33)\n",
    "print(\"In the process, the dataset got truncated to \" + str(round(100*train_sample.shape[0]/train.shape[0],2)) + \" % of the size. \\n\")\n",
    "print(\"Overall there are \" + str(train['session_id'].nunique()) + \n",
    "      \" unique sessions, that's mean an average length of \" + str(train.shape[0]/train['session_id'].nunique()) + \" per session. \\n\")\n",
    "print (train_sample.head(2),train_sample.shape)\n",
    "\n",
    "train_sample.to_csv(target_path+'train_sample.csv', sep=',', index=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 2) build dataset for meta-informations:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "def smaller_data_set(ds,samples):\n",
    "    rr = random.sample(range(0,ds.shape[0]),samples)\n",
    "    ds = ds.iloc[rr,:]\n",
    "    return ds\n",
    "\n",
    "\n",
    "def create_metadata(path,cutoff=1): #use per default the whole metadata informations\n",
    "    ds= get_data_pure(path)\n",
    "    np.random.seed(3333)\n",
    "    samples = round(len(ds)*cutoff) # use a specific ratio of the metadata (per default use all)\n",
    "    ds2 = smaller_data_set(ds,samples) #truncate data\n",
    "    x = ds2.set_index('item_id', drop=False, append=True).properties.str.split('|', expand=True).stack()\n",
    "    #split up the data string that is just seperated by \"|\"s \n",
    "\n",
    "    print (\"creating metadata matrix.. \\n\")\n",
    "    ds3 = pd.get_dummies(x, prefix=None, prefix_sep=None).groupby(level=1, sort=False).agg(max)\n",
    "    return ds3\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "creating metadata matrix.. \n",
      "\n",
      "(927142, 157)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>1 Star</th>\n",
       "      <th>2 Star</th>\n",
       "      <th>3 Star</th>\n",
       "      <th>4 Star</th>\n",
       "      <th>5 Star</th>\n",
       "      <th>Accessible Hotel</th>\n",
       "      <th>Accessible Parking</th>\n",
       "      <th>Adults Only</th>\n",
       "      <th>Air Conditioning</th>\n",
       "      <th>Airport Hotel</th>\n",
       "      <th>...</th>\n",
       "      <th>Terrace (Hotel)</th>\n",
       "      <th>Theme Hotel</th>\n",
       "      <th>Towels</th>\n",
       "      <th>Very Good Rating</th>\n",
       "      <th>Volleyball</th>\n",
       "      <th>Washing Machine</th>\n",
       "      <th>Water Slide</th>\n",
       "      <th>Wheelchair Accessible</th>\n",
       "      <th>WiFi (Public Areas)</th>\n",
       "      <th>WiFi (Rooms)</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>item_id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>8478046</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8815728</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5761022</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2976466</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8941598</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 157 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         1 Star  2 Star  3 Star  4 Star  5 Star  Accessible Hotel  \\\n",
       "item_id                                                             \n",
       "8478046       0       0       0       0       0                 0   \n",
       "8815728       0       0       0       0       0                 0   \n",
       "5761022       0       0       0       0       0                 0   \n",
       "2976466       0       0       0       0       1                 0   \n",
       "8941598       0       0       0       0       0                 0   \n",
       "\n",
       "         Accessible Parking  Adults Only  Air Conditioning  Airport Hotel  \\\n",
       "item_id                                                                     \n",
       "8478046                   0            0                 0              0   \n",
       "8815728                   0            0                 0              0   \n",
       "5761022                   0            0                 0              0   \n",
       "2976466                   0            0                 1              0   \n",
       "8941598                   0            0                 0              0   \n",
       "\n",
       "             ...       Terrace (Hotel)  Theme Hotel  Towels  Very Good Rating  \\\n",
       "item_id      ...                                                                \n",
       "8478046      ...                     0            0       0                 0   \n",
       "8815728      ...                     0            0       0                 0   \n",
       "5761022      ...                     0            0       0                 0   \n",
       "2976466      ...                     1            0       0                 1   \n",
       "8941598      ...                     0            0       0                 0   \n",
       "\n",
       "         Volleyball  Washing Machine  Water Slide  Wheelchair Accessible  \\\n",
       "item_id                                                                    \n",
       "8478046           0                0            0                      0   \n",
       "8815728           0                0            0                      0   \n",
       "5761022           0                0            0                      0   \n",
       "2976466           0                0            0                      0   \n",
       "8941598           0                0            0                      0   \n",
       "\n",
       "         WiFi (Public Areas)  WiFi (Rooms)  \n",
       "item_id                                     \n",
       "8478046                    0             0  \n",
       "8815728                    0             0  \n",
       "5761022                    1             1  \n",
       "2976466                    0             0  \n",
       "8941598                    0             0  \n",
       "\n",
       "[5 rows x 157 columns]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "metadata = create_metadata(\"item_metadata.csv\",cutoff=1) #use all available data\n",
    "print(metadata.shape)\n",
    "display (metadata.head(5))\n",
    "#metadata.to_csv(target_path+'metadata.csv', sep=',', index=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 3) Edit training data set to make it eligible for a statistical model\n",
    "\n",
    "## 3.1) Truncate data for the last destination:\n",
    "This means all rows are omitted that do not correspond to the destination that was clicked out last. To see why this is a problem, you can check with the Full Code."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "def trunc_last_dest(df):\n",
    "    \n",
    "    #first: contruct dataframe with session_id and the last corresponding step (=LAST clickout)\n",
    "    last_ev = pd.DataFrame(df.groupby(['session_id']).step.last(),columns=['step'])\n",
    "    last_ev.reset_index(level=0, inplace=True) #convert index session_id to an actual column\n",
    "     \n",
    "    #second: merge with city (= destination at the final clickout) : \n",
    "    last_city = pd.merge(last_ev, df[[\"session_id\",\"step\",\"city\"]], left_on=[\"session_id\",\"step\"], right_on=[\"session_id\",\"step\"])\n",
    "    \n",
    "    #third: get back the original full dataset (=all columns), but this time only for the rows whose destination is similar\n",
    "    #to the last destination: \n",
    "    df_restr = pd.merge(df,last_city[[\"session_id\",\"city\"]],on=[\"session_id\",\"city\"])\n",
    "    \n",
    "    return df_restr"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Corresponding loss of dimensionality: \n",
      "\n",
      "(5238803, 12)\n",
      "(4586228, 12)\n"
     ]
    }
   ],
   "source": [
    "#test_restr=trunc_last_dest(test)\n",
    "df1=trunc_last_dest(train_sample)\n",
    "print(\"Corresponding loss of dimensionality: \\n\")\n",
    "print(train_sample.shape)\n",
    "print(df1.shape)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 3.2) Clean the data:\n",
    "Remove sessions where reference=NA or the impressions list is empty for the clickout item:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "def clean_data(df):\n",
    "    \n",
    "    #first: contruct dataframe with session_id and the reference at the last corresponding step (=LAST clickout)\n",
    "    last_ref = pd.DataFrame(df.groupby(['session_id']).reference.last(),columns=['reference'])\n",
    "    last_ref.reset_index(level=0, inplace=True) #convert index session_id to an actual column\n",
    "     \n",
    "    #second: same for impressions list: \n",
    "    last_imp = pd.DataFrame(df.groupby(['session_id']).impressions.last(),columns=['impressions'])\n",
    "    last_imp.reset_index(level=0, inplace=True)\n",
    "    \n",
    "    #third: merge together => columns: sessions_id, reference, impressions\n",
    "    temp = pd.merge(last_ref, last_imp, left_on=[\"session_id\"], right_on=[\"session_id\"])\n",
    "    \n",
    "    \n",
    "    #fourth step: remove irrelevant sessions: \n",
    "    temp2=temp[temp.reference.apply(lambda x: x.isnumeric())] #drop session if reference value is not a number\n",
    "    temp3= temp2.dropna(axis=0,subset=['impressions']) #drop session if impressions list is NaN\n",
    "\n",
    "    #fifth step: get back the original full dataset (=all columns)\n",
    "    out = pd.merge(df,pd.DataFrame(temp3[\"session_id\"]),on=[\"session_id\"])\n",
    "    \n",
    "    return out"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Corresponding loss of dimensionality: \n",
      "\n",
      "(4586228, 12)\n",
      "(3875853, 12)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>user_id</th>\n",
       "      <th>session_id</th>\n",
       "      <th>timestamp</th>\n",
       "      <th>step</th>\n",
       "      <th>action_type</th>\n",
       "      <th>reference</th>\n",
       "      <th>platform</th>\n",
       "      <th>city</th>\n",
       "      <th>device</th>\n",
       "      <th>current_filters</th>\n",
       "      <th>impressions</th>\n",
       "      <th>prices</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063730</td>\n",
       "      <td>1</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063730</td>\n",
       "      <td>2</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063740</td>\n",
       "      <td>3</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063740</td>\n",
       "      <td>4</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063740</td>\n",
       "      <td>5</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063750</td>\n",
       "      <td>6</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063760</td>\n",
       "      <td>7</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063760</td>\n",
       "      <td>8</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063760</td>\n",
       "      <td>9</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063770</td>\n",
       "      <td>10</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063770</td>\n",
       "      <td>11</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063770</td>\n",
       "      <td>12</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063770</td>\n",
       "      <td>13</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063770</td>\n",
       "      <td>14</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063770</td>\n",
       "      <td>15</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063770</td>\n",
       "      <td>16</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063780</td>\n",
       "      <td>17</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063780</td>\n",
       "      <td>18</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063790</td>\n",
       "      <td>19</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063790</td>\n",
       "      <td>20</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063790</td>\n",
       "      <td>21</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063790</td>\n",
       "      <td>22</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063790</td>\n",
       "      <td>23</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063800</td>\n",
       "      <td>24</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063800</td>\n",
       "      <td>25</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063800</td>\n",
       "      <td>26</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063810</td>\n",
       "      <td>27</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063810</td>\n",
       "      <td>28</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063810</td>\n",
       "      <td>29</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>02SRUT1NQYH1</td>\n",
       "      <td>3599a6f709eab</td>\n",
       "      <td>1541063810</td>\n",
       "      <td>30</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>2795374</td>\n",
       "      <td>FI</td>\n",
       "      <td>Krakow, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875823</th>\n",
       "      <td>Z5AV3B5DKRO1</td>\n",
       "      <td>4a75dae9bc390</td>\n",
       "      <td>1541477483</td>\n",
       "      <td>4</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>1108295</td>\n",
       "      <td>MX</td>\n",
       "      <td>Mazatlán, Mexico</td>\n",
       "      <td>desktop</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875824</th>\n",
       "      <td>Z5AV3B5DKRO1</td>\n",
       "      <td>4a75dae9bc390</td>\n",
       "      <td>1541477483</td>\n",
       "      <td>5</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>1108295</td>\n",
       "      <td>MX</td>\n",
       "      <td>Mazatlán, Mexico</td>\n",
       "      <td>desktop</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875825</th>\n",
       "      <td>Z5AV3B5DKRO1</td>\n",
       "      <td>4a75dae9bc390</td>\n",
       "      <td>1541477483</td>\n",
       "      <td>6</td>\n",
       "      <td>interaction item rating</td>\n",
       "      <td>1108295</td>\n",
       "      <td>MX</td>\n",
       "      <td>Mazatlán, Mexico</td>\n",
       "      <td>desktop</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875826</th>\n",
       "      <td>Z5AV3B5DKRO1</td>\n",
       "      <td>4a75dae9bc390</td>\n",
       "      <td>1541477483</td>\n",
       "      <td>7</td>\n",
       "      <td>interaction item info</td>\n",
       "      <td>1108295</td>\n",
       "      <td>MX</td>\n",
       "      <td>Mazatlán, Mexico</td>\n",
       "      <td>desktop</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875827</th>\n",
       "      <td>Z5AV3B5DKRO1</td>\n",
       "      <td>4a75dae9bc390</td>\n",
       "      <td>1541477483</td>\n",
       "      <td>8</td>\n",
       "      <td>interaction item deals</td>\n",
       "      <td>1108295</td>\n",
       "      <td>MX</td>\n",
       "      <td>Mazatlán, Mexico</td>\n",
       "      <td>desktop</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875828</th>\n",
       "      <td>Z5AV3B5DKRO1</td>\n",
       "      <td>4a75dae9bc390</td>\n",
       "      <td>1541477493</td>\n",
       "      <td>9</td>\n",
       "      <td>interaction item deals</td>\n",
       "      <td>1108295</td>\n",
       "      <td>MX</td>\n",
       "      <td>Mazatlán, Mexico</td>\n",
       "      <td>desktop</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875829</th>\n",
       "      <td>Z5AV3B5DKRO1</td>\n",
       "      <td>4a75dae9bc390</td>\n",
       "      <td>1541477547</td>\n",
       "      <td>10</td>\n",
       "      <td>interaction item deals</td>\n",
       "      <td>42736</td>\n",
       "      <td>MX</td>\n",
       "      <td>Mazatlán, Mexico</td>\n",
       "      <td>desktop</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875830</th>\n",
       "      <td>Z5AV3B5DKRO1</td>\n",
       "      <td>4a75dae9bc390</td>\n",
       "      <td>1541477568</td>\n",
       "      <td>11</td>\n",
       "      <td>clickout item</td>\n",
       "      <td>42736</td>\n",
       "      <td>MX</td>\n",
       "      <td>Mazatlán, Mexico</td>\n",
       "      <td>desktop</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1108295|6623552|1236111|34550|34556|34555|4274...</td>\n",
       "      <td>126|66|55|98|174|218|64|124|58|58|72|72|52|84|...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875831</th>\n",
       "      <td>ZE8M21HENJ91</td>\n",
       "      <td>f0cceac1f5925</td>\n",
       "      <td>1541516869</td>\n",
       "      <td>1</td>\n",
       "      <td>clickout item</td>\n",
       "      <td>1771251</td>\n",
       "      <td>PL</td>\n",
       "      <td>Radziejowice, Poland</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2199498|2258162|1826617|1771183|1771251|131913...</td>\n",
       "      <td>25|60|97|58|37|42|35|31|42|32|37|38|49|60|42|3...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875832</th>\n",
       "      <td>ZGLL26UBPRNB</td>\n",
       "      <td>f79dabc52921a</td>\n",
       "      <td>1541536456</td>\n",
       "      <td>1</td>\n",
       "      <td>clickout item</td>\n",
       "      <td>2713516</td>\n",
       "      <td>PH</td>\n",
       "      <td>Manila, Philippines</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2713516|203851|203861|203951|320736|320786|124...</td>\n",
       "      <td>22|93|157|120|52|97|262|68|109|136|242|34|21|1...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875833</th>\n",
       "      <td>ZHFK1BGB02JZ</td>\n",
       "      <td>61c453f41a671</td>\n",
       "      <td>1541505118</td>\n",
       "      <td>1</td>\n",
       "      <td>clickout item</td>\n",
       "      <td>40582</td>\n",
       "      <td>ES</td>\n",
       "      <td>Logroño, Spain</td>\n",
       "      <td>mobile</td>\n",
       "      <td>NaN</td>\n",
       "      <td>8189402|106828|40582|40393|40724|236576|207406...</td>\n",
       "      <td>80|62|60|61|82|79|68|71|75|124|54|45|64|75|75|...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875834</th>\n",
       "      <td>ZYNMLE3MV3LK</td>\n",
       "      <td>62728015bec05</td>\n",
       "      <td>1541544402</td>\n",
       "      <td>1</td>\n",
       "      <td>search for destination</td>\n",
       "      <td>Paris, France</td>\n",
       "      <td>PT</td>\n",
       "      <td>Paris, France</td>\n",
       "      <td>desktop</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875835</th>\n",
       "      <td>ZYNMLE3MV3LK</td>\n",
       "      <td>62728015bec05</td>\n",
       "      <td>1541544470</td>\n",
       "      <td>2</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>6617798</td>\n",
       "      <td>PT</td>\n",
       "      <td>Paris, France</td>\n",
       "      <td>desktop</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875836</th>\n",
       "      <td>ZYNMLE3MV3LK</td>\n",
       "      <td>62728015bec05</td>\n",
       "      <td>1541544470</td>\n",
       "      <td>3</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>6617798</td>\n",
       "      <td>PT</td>\n",
       "      <td>Paris, France</td>\n",
       "      <td>desktop</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875837</th>\n",
       "      <td>ZYNMLE3MV3LK</td>\n",
       "      <td>62728015bec05</td>\n",
       "      <td>1541544480</td>\n",
       "      <td>4</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>6617798</td>\n",
       "      <td>PT</td>\n",
       "      <td>Paris, France</td>\n",
       "      <td>desktop</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875838</th>\n",
       "      <td>ZYNMLE3MV3LK</td>\n",
       "      <td>62728015bec05</td>\n",
       "      <td>1541544480</td>\n",
       "      <td>5</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>6617798</td>\n",
       "      <td>PT</td>\n",
       "      <td>Paris, France</td>\n",
       "      <td>desktop</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875839</th>\n",
       "      <td>ZYNMLE3MV3LK</td>\n",
       "      <td>62728015bec05</td>\n",
       "      <td>1541544480</td>\n",
       "      <td>6</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>6617798</td>\n",
       "      <td>PT</td>\n",
       "      <td>Paris, France</td>\n",
       "      <td>desktop</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875840</th>\n",
       "      <td>ZYNMLE3MV3LK</td>\n",
       "      <td>62728015bec05</td>\n",
       "      <td>1541544480</td>\n",
       "      <td>7</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>6617798</td>\n",
       "      <td>PT</td>\n",
       "      <td>Paris, France</td>\n",
       "      <td>desktop</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875841</th>\n",
       "      <td>ZYNMLE3MV3LK</td>\n",
       "      <td>62728015bec05</td>\n",
       "      <td>1541544480</td>\n",
       "      <td>8</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>6617798</td>\n",
       "      <td>PT</td>\n",
       "      <td>Paris, France</td>\n",
       "      <td>desktop</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875842</th>\n",
       "      <td>ZYNMLE3MV3LK</td>\n",
       "      <td>62728015bec05</td>\n",
       "      <td>1541544480</td>\n",
       "      <td>9</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>6617798</td>\n",
       "      <td>PT</td>\n",
       "      <td>Paris, France</td>\n",
       "      <td>desktop</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875843</th>\n",
       "      <td>ZYNMLE3MV3LK</td>\n",
       "      <td>62728015bec05</td>\n",
       "      <td>1541544480</td>\n",
       "      <td>10</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>6617798</td>\n",
       "      <td>PT</td>\n",
       "      <td>Paris, France</td>\n",
       "      <td>desktop</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875844</th>\n",
       "      <td>ZYNMLE3MV3LK</td>\n",
       "      <td>62728015bec05</td>\n",
       "      <td>1541544480</td>\n",
       "      <td>11</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>6617798</td>\n",
       "      <td>PT</td>\n",
       "      <td>Paris, France</td>\n",
       "      <td>desktop</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875845</th>\n",
       "      <td>ZYNMLE3MV3LK</td>\n",
       "      <td>62728015bec05</td>\n",
       "      <td>1541544480</td>\n",
       "      <td>12</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>6617798</td>\n",
       "      <td>PT</td>\n",
       "      <td>Paris, France</td>\n",
       "      <td>desktop</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875846</th>\n",
       "      <td>ZYNMLE3MV3LK</td>\n",
       "      <td>62728015bec05</td>\n",
       "      <td>1541544480</td>\n",
       "      <td>13</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>6617798</td>\n",
       "      <td>PT</td>\n",
       "      <td>Paris, France</td>\n",
       "      <td>desktop</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875847</th>\n",
       "      <td>ZYNMLE3MV3LK</td>\n",
       "      <td>62728015bec05</td>\n",
       "      <td>1541544480</td>\n",
       "      <td>14</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>6617798</td>\n",
       "      <td>PT</td>\n",
       "      <td>Paris, France</td>\n",
       "      <td>desktop</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875848</th>\n",
       "      <td>ZYNMLE3MV3LK</td>\n",
       "      <td>62728015bec05</td>\n",
       "      <td>1541544490</td>\n",
       "      <td>15</td>\n",
       "      <td>interaction item image</td>\n",
       "      <td>6617798</td>\n",
       "      <td>PT</td>\n",
       "      <td>Paris, France</td>\n",
       "      <td>desktop</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875849</th>\n",
       "      <td>ZYNMLE3MV3LK</td>\n",
       "      <td>62728015bec05</td>\n",
       "      <td>1541544491</td>\n",
       "      <td>16</td>\n",
       "      <td>clickout item</td>\n",
       "      <td>6617798</td>\n",
       "      <td>PT</td>\n",
       "      <td>Paris, France</td>\n",
       "      <td>desktop</td>\n",
       "      <td>Focus on Distance</td>\n",
       "      <td>6617798|1263420|9567886|1161323|149768|1890735...</td>\n",
       "      <td>58|96|55|75|90|60|233|104|150|145|328|207|150|...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875850</th>\n",
       "      <td>ZYNMLE3MV3LK</td>\n",
       "      <td>62728015bec05</td>\n",
       "      <td>1541544540</td>\n",
       "      <td>17</td>\n",
       "      <td>clickout item</td>\n",
       "      <td>2712342</td>\n",
       "      <td>PT</td>\n",
       "      <td>Paris, France</td>\n",
       "      <td>desktop</td>\n",
       "      <td>Focus on Distance</td>\n",
       "      <td>6617798|1263420|9567886|1161323|149768|1890735...</td>\n",
       "      <td>58|96|55|75|90|60|233|104|150|145|328|207|150|...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875851</th>\n",
       "      <td>ZYNMLE3MV3LK</td>\n",
       "      <td>62728015bec05</td>\n",
       "      <td>1541544967</td>\n",
       "      <td>18</td>\n",
       "      <td>change of sort order</td>\n",
       "      <td>interaction sort button</td>\n",
       "      <td>PT</td>\n",
       "      <td>Paris, France</td>\n",
       "      <td>desktop</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3875852</th>\n",
       "      <td>ZYNMLE3MV3LK</td>\n",
       "      <td>62728015bec05</td>\n",
       "      <td>1541544973</td>\n",
       "      <td>19</td>\n",
       "      <td>clickout item</td>\n",
       "      <td>1161323</td>\n",
       "      <td>PT</td>\n",
       "      <td>Paris, France</td>\n",
       "      <td>desktop</td>\n",
       "      <td>Focus on Distance</td>\n",
       "      <td>6617798|1263420|9567886|1161323|149768|1890735...</td>\n",
       "      <td>58|96|55|75|90|60|233|104|150|145|328|207|150|...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3875853 rows × 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "              user_id     session_id   timestamp step  \\\n",
       "0        02SRUT1NQYH1  3599a6f709eab  1541063730    1   \n",
       "1        02SRUT1NQYH1  3599a6f709eab  1541063730    2   \n",
       "2        02SRUT1NQYH1  3599a6f709eab  1541063740    3   \n",
       "3        02SRUT1NQYH1  3599a6f709eab  1541063740    4   \n",
       "4        02SRUT1NQYH1  3599a6f709eab  1541063740    5   \n",
       "5        02SRUT1NQYH1  3599a6f709eab  1541063750    6   \n",
       "6        02SRUT1NQYH1  3599a6f709eab  1541063760    7   \n",
       "7        02SRUT1NQYH1  3599a6f709eab  1541063760    8   \n",
       "8        02SRUT1NQYH1  3599a6f709eab  1541063760    9   \n",
       "9        02SRUT1NQYH1  3599a6f709eab  1541063770   10   \n",
       "10       02SRUT1NQYH1  3599a6f709eab  1541063770   11   \n",
       "11       02SRUT1NQYH1  3599a6f709eab  1541063770   12   \n",
       "12       02SRUT1NQYH1  3599a6f709eab  1541063770   13   \n",
       "13       02SRUT1NQYH1  3599a6f709eab  1541063770   14   \n",
       "14       02SRUT1NQYH1  3599a6f709eab  1541063770   15   \n",
       "15       02SRUT1NQYH1  3599a6f709eab  1541063770   16   \n",
       "16       02SRUT1NQYH1  3599a6f709eab  1541063780   17   \n",
       "17       02SRUT1NQYH1  3599a6f709eab  1541063780   18   \n",
       "18       02SRUT1NQYH1  3599a6f709eab  1541063790   19   \n",
       "19       02SRUT1NQYH1  3599a6f709eab  1541063790   20   \n",
       "20       02SRUT1NQYH1  3599a6f709eab  1541063790   21   \n",
       "21       02SRUT1NQYH1  3599a6f709eab  1541063790   22   \n",
       "22       02SRUT1NQYH1  3599a6f709eab  1541063790   23   \n",
       "23       02SRUT1NQYH1  3599a6f709eab  1541063800   24   \n",
       "24       02SRUT1NQYH1  3599a6f709eab  1541063800   25   \n",
       "25       02SRUT1NQYH1  3599a6f709eab  1541063800   26   \n",
       "26       02SRUT1NQYH1  3599a6f709eab  1541063810   27   \n",
       "27       02SRUT1NQYH1  3599a6f709eab  1541063810   28   \n",
       "28       02SRUT1NQYH1  3599a6f709eab  1541063810   29   \n",
       "29       02SRUT1NQYH1  3599a6f709eab  1541063810   30   \n",
       "...               ...            ...         ...  ...   \n",
       "3875823  Z5AV3B5DKRO1  4a75dae9bc390  1541477483    4   \n",
       "3875824  Z5AV3B5DKRO1  4a75dae9bc390  1541477483    5   \n",
       "3875825  Z5AV3B5DKRO1  4a75dae9bc390  1541477483    6   \n",
       "3875826  Z5AV3B5DKRO1  4a75dae9bc390  1541477483    7   \n",
       "3875827  Z5AV3B5DKRO1  4a75dae9bc390  1541477483    8   \n",
       "3875828  Z5AV3B5DKRO1  4a75dae9bc390  1541477493    9   \n",
       "3875829  Z5AV3B5DKRO1  4a75dae9bc390  1541477547   10   \n",
       "3875830  Z5AV3B5DKRO1  4a75dae9bc390  1541477568   11   \n",
       "3875831  ZE8M21HENJ91  f0cceac1f5925  1541516869    1   \n",
       "3875832  ZGLL26UBPRNB  f79dabc52921a  1541536456    1   \n",
       "3875833  ZHFK1BGB02JZ  61c453f41a671  1541505118    1   \n",
       "3875834  ZYNMLE3MV3LK  62728015bec05  1541544402    1   \n",
       "3875835  ZYNMLE3MV3LK  62728015bec05  1541544470    2   \n",
       "3875836  ZYNMLE3MV3LK  62728015bec05  1541544470    3   \n",
       "3875837  ZYNMLE3MV3LK  62728015bec05  1541544480    4   \n",
       "3875838  ZYNMLE3MV3LK  62728015bec05  1541544480    5   \n",
       "3875839  ZYNMLE3MV3LK  62728015bec05  1541544480    6   \n",
       "3875840  ZYNMLE3MV3LK  62728015bec05  1541544480    7   \n",
       "3875841  ZYNMLE3MV3LK  62728015bec05  1541544480    8   \n",
       "3875842  ZYNMLE3MV3LK  62728015bec05  1541544480    9   \n",
       "3875843  ZYNMLE3MV3LK  62728015bec05  1541544480   10   \n",
       "3875844  ZYNMLE3MV3LK  62728015bec05  1541544480   11   \n",
       "3875845  ZYNMLE3MV3LK  62728015bec05  1541544480   12   \n",
       "3875846  ZYNMLE3MV3LK  62728015bec05  1541544480   13   \n",
       "3875847  ZYNMLE3MV3LK  62728015bec05  1541544480   14   \n",
       "3875848  ZYNMLE3MV3LK  62728015bec05  1541544490   15   \n",
       "3875849  ZYNMLE3MV3LK  62728015bec05  1541544491   16   \n",
       "3875850  ZYNMLE3MV3LK  62728015bec05  1541544540   17   \n",
       "3875851  ZYNMLE3MV3LK  62728015bec05  1541544967   18   \n",
       "3875852  ZYNMLE3MV3LK  62728015bec05  1541544973   19   \n",
       "\n",
       "                     action_type                reference platform  \\\n",
       "0         interaction item image                  2795374       FI   \n",
       "1         interaction item image                  2795374       FI   \n",
       "2         interaction item image                  2795374       FI   \n",
       "3         interaction item image                  2795374       FI   \n",
       "4         interaction item image                  2795374       FI   \n",
       "5         interaction item image                  2795374       FI   \n",
       "6         interaction item image                  2795374       FI   \n",
       "7         interaction item image                  2795374       FI   \n",
       "8         interaction item image                  2795374       FI   \n",
       "9         interaction item image                  2795374       FI   \n",
       "10        interaction item image                  2795374       FI   \n",
       "11        interaction item image                  2795374       FI   \n",
       "12        interaction item image                  2795374       FI   \n",
       "13        interaction item image                  2795374       FI   \n",
       "14        interaction item image                  2795374       FI   \n",
       "15        interaction item image                  2795374       FI   \n",
       "16        interaction item image                  2795374       FI   \n",
       "17        interaction item image                  2795374       FI   \n",
       "18        interaction item image                  2795374       FI   \n",
       "19        interaction item image                  2795374       FI   \n",
       "20        interaction item image                  2795374       FI   \n",
       "21        interaction item image                  2795374       FI   \n",
       "22        interaction item image                  2795374       FI   \n",
       "23        interaction item image                  2795374       FI   \n",
       "24        interaction item image                  2795374       FI   \n",
       "25        interaction item image                  2795374       FI   \n",
       "26        interaction item image                  2795374       FI   \n",
       "27        interaction item image                  2795374       FI   \n",
       "28        interaction item image                  2795374       FI   \n",
       "29        interaction item image                  2795374       FI   \n",
       "...                          ...                      ...      ...   \n",
       "3875823   interaction item image                  1108295       MX   \n",
       "3875824   interaction item image                  1108295       MX   \n",
       "3875825  interaction item rating                  1108295       MX   \n",
       "3875826    interaction item info                  1108295       MX   \n",
       "3875827   interaction item deals                  1108295       MX   \n",
       "3875828   interaction item deals                  1108295       MX   \n",
       "3875829   interaction item deals                    42736       MX   \n",
       "3875830            clickout item                    42736       MX   \n",
       "3875831            clickout item                  1771251       PL   \n",
       "3875832            clickout item                  2713516       PH   \n",
       "3875833            clickout item                    40582       ES   \n",
       "3875834   search for destination            Paris, France       PT   \n",
       "3875835   interaction item image                  6617798       PT   \n",
       "3875836   interaction item image                  6617798       PT   \n",
       "3875837   interaction item image                  6617798       PT   \n",
       "3875838   interaction item image                  6617798       PT   \n",
       "3875839   interaction item image                  6617798       PT   \n",
       "3875840   interaction item image                  6617798       PT   \n",
       "3875841   interaction item image                  6617798       PT   \n",
       "3875842   interaction item image                  6617798       PT   \n",
       "3875843   interaction item image                  6617798       PT   \n",
       "3875844   interaction item image                  6617798       PT   \n",
       "3875845   interaction item image                  6617798       PT   \n",
       "3875846   interaction item image                  6617798       PT   \n",
       "3875847   interaction item image                  6617798       PT   \n",
       "3875848   interaction item image                  6617798       PT   \n",
       "3875849            clickout item                  6617798       PT   \n",
       "3875850            clickout item                  2712342       PT   \n",
       "3875851     change of sort order  interaction sort button       PT   \n",
       "3875852            clickout item                  1161323       PT   \n",
       "\n",
       "                         city   device    current_filters  \\\n",
       "0              Krakow, Poland   mobile                NaN   \n",
       "1              Krakow, Poland   mobile                NaN   \n",
       "2              Krakow, Poland   mobile                NaN   \n",
       "3              Krakow, Poland   mobile                NaN   \n",
       "4              Krakow, Poland   mobile                NaN   \n",
       "5              Krakow, Poland   mobile                NaN   \n",
       "6              Krakow, Poland   mobile                NaN   \n",
       "7              Krakow, Poland   mobile                NaN   \n",
       "8              Krakow, Poland   mobile                NaN   \n",
       "9              Krakow, Poland   mobile                NaN   \n",
       "10             Krakow, Poland   mobile                NaN   \n",
       "11             Krakow, Poland   mobile                NaN   \n",
       "12             Krakow, Poland   mobile                NaN   \n",
       "13             Krakow, Poland   mobile                NaN   \n",
       "14             Krakow, Poland   mobile                NaN   \n",
       "15             Krakow, Poland   mobile                NaN   \n",
       "16             Krakow, Poland   mobile                NaN   \n",
       "17             Krakow, Poland   mobile                NaN   \n",
       "18             Krakow, Poland   mobile                NaN   \n",
       "19             Krakow, Poland   mobile                NaN   \n",
       "20             Krakow, Poland   mobile                NaN   \n",
       "21             Krakow, Poland   mobile                NaN   \n",
       "22             Krakow, Poland   mobile                NaN   \n",
       "23             Krakow, Poland   mobile                NaN   \n",
       "24             Krakow, Poland   mobile                NaN   \n",
       "25             Krakow, Poland   mobile                NaN   \n",
       "26             Krakow, Poland   mobile                NaN   \n",
       "27             Krakow, Poland   mobile                NaN   \n",
       "28             Krakow, Poland   mobile                NaN   \n",
       "29             Krakow, Poland   mobile                NaN   \n",
       "...                       ...      ...                ...   \n",
       "3875823      Mazatlán, Mexico  desktop                NaN   \n",
       "3875824      Mazatlán, Mexico  desktop                NaN   \n",
       "3875825      Mazatlán, Mexico  desktop                NaN   \n",
       "3875826      Mazatlán, Mexico  desktop                NaN   \n",
       "3875827      Mazatlán, Mexico  desktop                NaN   \n",
       "3875828      Mazatlán, Mexico  desktop                NaN   \n",
       "3875829      Mazatlán, Mexico  desktop                NaN   \n",
       "3875830      Mazatlán, Mexico  desktop                NaN   \n",
       "3875831  Radziejowice, Poland   mobile                NaN   \n",
       "3875832   Manila, Philippines   mobile                NaN   \n",
       "3875833        Logroño, Spain   mobile                NaN   \n",
       "3875834         Paris, France  desktop                NaN   \n",
       "3875835         Paris, France  desktop                NaN   \n",
       "3875836         Paris, France  desktop                NaN   \n",
       "3875837         Paris, France  desktop                NaN   \n",
       "3875838         Paris, France  desktop                NaN   \n",
       "3875839         Paris, France  desktop                NaN   \n",
       "3875840         Paris, France  desktop                NaN   \n",
       "3875841         Paris, France  desktop                NaN   \n",
       "3875842         Paris, France  desktop                NaN   \n",
       "3875843         Paris, France  desktop                NaN   \n",
       "3875844         Paris, France  desktop                NaN   \n",
       "3875845         Paris, France  desktop                NaN   \n",
       "3875846         Paris, France  desktop                NaN   \n",
       "3875847         Paris, France  desktop                NaN   \n",
       "3875848         Paris, France  desktop                NaN   \n",
       "3875849         Paris, France  desktop  Focus on Distance   \n",
       "3875850         Paris, France  desktop  Focus on Distance   \n",
       "3875851         Paris, France  desktop                NaN   \n",
       "3875852         Paris, France  desktop  Focus on Distance   \n",
       "\n",
       "                                               impressions  \\\n",
       "0                                                      NaN   \n",
       "1                                                      NaN   \n",
       "2                                                      NaN   \n",
       "3                                                      NaN   \n",
       "4                                                      NaN   \n",
       "5                                                      NaN   \n",
       "6                                                      NaN   \n",
       "7                                                      NaN   \n",
       "8                                                      NaN   \n",
       "9                                                      NaN   \n",
       "10                                                     NaN   \n",
       "11                                                     NaN   \n",
       "12                                                     NaN   \n",
       "13                                                     NaN   \n",
       "14                                                     NaN   \n",
       "15                                                     NaN   \n",
       "16                                                     NaN   \n",
       "17                                                     NaN   \n",
       "18                                                     NaN   \n",
       "19                                                     NaN   \n",
       "20                                                     NaN   \n",
       "21                                                     NaN   \n",
       "22                                                     NaN   \n",
       "23                                                     NaN   \n",
       "24                                                     NaN   \n",
       "25                                                     NaN   \n",
       "26                                                     NaN   \n",
       "27                                                     NaN   \n",
       "28                                                     NaN   \n",
       "29                                                     NaN   \n",
       "...                                                    ...   \n",
       "3875823                                                NaN   \n",
       "3875824                                                NaN   \n",
       "3875825                                                NaN   \n",
       "3875826                                                NaN   \n",
       "3875827                                                NaN   \n",
       "3875828                                                NaN   \n",
       "3875829                                                NaN   \n",
       "3875830  1108295|6623552|1236111|34550|34556|34555|4274...   \n",
       "3875831  2199498|2258162|1826617|1771183|1771251|131913...   \n",
       "3875832  2713516|203851|203861|203951|320736|320786|124...   \n",
       "3875833  8189402|106828|40582|40393|40724|236576|207406...   \n",
       "3875834                                                NaN   \n",
       "3875835                                                NaN   \n",
       "3875836                                                NaN   \n",
       "3875837                                                NaN   \n",
       "3875838                                                NaN   \n",
       "3875839                                                NaN   \n",
       "3875840                                                NaN   \n",
       "3875841                                                NaN   \n",
       "3875842                                                NaN   \n",
       "3875843                                                NaN   \n",
       "3875844                                                NaN   \n",
       "3875845                                                NaN   \n",
       "3875846                                                NaN   \n",
       "3875847                                                NaN   \n",
       "3875848                                                NaN   \n",
       "3875849  6617798|1263420|9567886|1161323|149768|1890735...   \n",
       "3875850  6617798|1263420|9567886|1161323|149768|1890735...   \n",
       "3875851                                                NaN   \n",
       "3875852  6617798|1263420|9567886|1161323|149768|1890735...   \n",
       "\n",
       "                                                    prices  \n",
       "0                                                      NaN  \n",
       "1                                                      NaN  \n",
       "2                                                      NaN  \n",
       "3                                                      NaN  \n",
       "4                                                      NaN  \n",
       "5                                                      NaN  \n",
       "6                                                      NaN  \n",
       "7                                                      NaN  \n",
       "8                                                      NaN  \n",
       "9                                                      NaN  \n",
       "10                                                     NaN  \n",
       "11                                                     NaN  \n",
       "12                                                     NaN  \n",
       "13                                                     NaN  \n",
       "14                                                     NaN  \n",
       "15                                                     NaN  \n",
       "16                                                     NaN  \n",
       "17                                                     NaN  \n",
       "18                                                     NaN  \n",
       "19                                                     NaN  \n",
       "20                                                     NaN  \n",
       "21                                                     NaN  \n",
       "22                                                     NaN  \n",
       "23                                                     NaN  \n",
       "24                                                     NaN  \n",
       "25                                                     NaN  \n",
       "26                                                     NaN  \n",
       "27                                                     NaN  \n",
       "28                                                     NaN  \n",
       "29                                                     NaN  \n",
       "...                                                    ...  \n",
       "3875823                                                NaN  \n",
       "3875824                                                NaN  \n",
       "3875825                                                NaN  \n",
       "3875826                                                NaN  \n",
       "3875827                                                NaN  \n",
       "3875828                                                NaN  \n",
       "3875829                                                NaN  \n",
       "3875830  126|66|55|98|174|218|64|124|58|58|72|72|52|84|...  \n",
       "3875831  25|60|97|58|37|42|35|31|42|32|37|38|49|60|42|3...  \n",
       "3875832  22|93|157|120|52|97|262|68|109|136|242|34|21|1...  \n",
       "3875833  80|62|60|61|82|79|68|71|75|124|54|45|64|75|75|...  \n",
       "3875834                                                NaN  \n",
       "3875835                                                NaN  \n",
       "3875836                                                NaN  \n",
       "3875837                                                NaN  \n",
       "3875838                                                NaN  \n",
       "3875839                                                NaN  \n",
       "3875840                                                NaN  \n",
       "3875841                                                NaN  \n",
       "3875842                                                NaN  \n",
       "3875843                                                NaN  \n",
       "3875844                                                NaN  \n",
       "3875845                                                NaN  \n",
       "3875846                                                NaN  \n",
       "3875847                                                NaN  \n",
       "3875848                                                NaN  \n",
       "3875849  58|96|55|75|90|60|233|104|150|145|328|207|150|...  \n",
       "3875850  58|96|55|75|90|60|233|104|150|145|328|207|150|...  \n",
       "3875851                                                NaN  \n",
       "3875852  58|96|55|75|90|60|233|104|150|145|328|207|150|...  \n",
       "\n",
       "[3875853 rows x 12 columns]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "df2=clean_data(df1)\n",
    "print(\"Corresponding loss of dimensionality: \\n\")\n",
    "print(df1.shape)\n",
    "print(df2.shape)\n",
    "display(df2)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.1"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
